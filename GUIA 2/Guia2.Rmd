---
title: "Guia 2"
author: "Grupo 3"
date: "10/19/2019"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(dplyr)
library(mvtnorm)
source('./RedRBF.R')
source('./PerceptronSimple.R')
```


## Ejercicio 1

### Resolución del problema XOR con una red neuronal RBF

 - Lectura de los patrones de entrenamiento
 
```{r message=FALSE}
XOR_trn <- read_csv("../../PUBLICO/Encuentro 1/Práctica/data/XOR_trn.csv", col_names = FALSE)
XOR_tst <- read_csv("../../PUBLICO/Encuentro 1/Práctica/data/XOR_tst.csv", col_names = FALSE)
```
 
 - Selección de parámetros y entrenamiento de perceptrón
 
En este caso se utilizan 4 gausianas por la distribución de los datos.

```{r}
datos_x <- XOR_trn[,c(1,2)]
datos_y <- XOR_trn[,3]
modeloRBF <- redRBF(datos_x, datos_y, nroGausianas = 4, funcion = "sigmo")
```

 - Prueba con datos de test
 
```{r}
datos_x <- XOR_tst[,c(1,2)]
datos_y <- XOR_tst[,3]
salida <- aplicarRedRBF(modeloRBF, datos_x, datos_y)
salida$tasa
```

### Resolución del problema Iris con una red neuronal RBF

 - Lectura de los patrones de entrenamiento

```{r message=FALSE}
irisbin <- read_csv("../../PUBLICO/Encuentro 1/Práctica/data/irisbin.csv", col_names = FALSE)
```

- Selección de parámetros y entrenamiento de perceptrón

```{r include=FALSE}
datos_x <- irisbin[,c(1,2,3,4)]
datos_y <- irisbin[,c(5,6,7)]

#Falta aplicar criterio de Elbow para la selección de K

modeloRBF <- redRBF(datos_x, datos_y, nroGausianas = 10, funcion = "sigmo", pnu = 0.2, 
                    pepoca = 200, pcritFinalizacion = 0.9)
```

 - Prueba con datos 
 
```{r}
salida <- aplicarRedRBF(modeloRBF, datos_x, datos_y)
salida$tasa

head(salida$salida)


```

Cantidad de parametros:

En una red MLP con una estructura (3,1), tenemos los siguientes parámetros:

$ numParamMLP = Parámetros de Capa 1 + Parámetros de Capa 2 $
$ numParamMLP = [(4 entradas + 1) * 3 neuronas] + [(3 entradas + 1) * 1 neurona] $
$ numParamMLP = 5 * 3 + 4 * 1 = 19 parámetros $

Una red RBF con 19 parámetros podría tener la siguiente distribución:

$ numParamRBF = Parámetros de Gausianas + Parámetros de Perceptrones $
$ numParamRBF = [3 centros] + [(3 entradas + 1) * 3 neurona] $
$ numParamRBF = 3 + 4 * 3 = 15 parámetros $

```{r include=FALSE}
modeloRBF_2 <- redRBF(datos_x, datos_y, nroGausianas = 3, funcion = "sigmo", pnu = 0.2, 
                    pepoca = 200, pcritFinalizacion = 0.9)
```

 - Prueba con datos 
 
```{r}
salida_2 <- aplicarRedRBF(modeloRBF_2, datos_x, datos_y)
salida_2$tasa

head(salida_2$salida)
```


## Ejercicio 2

 - Lectura de datos
 
```{r message=FALSE}
library(readr)
library(dplyr)
library(mvtnorm)
source('./RedRBF.R')
source('./PerceptronSimple.R')

merval <- read_csv("../../PUBLICO/Encuentro 3/Práctica/data/merval.csv", col_names = FALSE)
```
 
 - Preprocesamiento de los datos
 
```{r}
cantidadDatos <- nrow(merval)
datos_merval <- matrix(0,nrow = cantidadDatos-5, ncol = 6)

for (i in seq(1,cantidadDatos-5)) {
  datos_merval[i,] <- merval$X1[seq(i,i+5)] 
}



```


```{r}
datos_x <- datos_merval[,c(1,2,3,4,5)] %>% as.matrix()
datos_y <- datos_merval[,6] %>% as.matrix()

#Falta aplicar criterio de Elbow para la selección de K

modeloMerval <- redRBF(datos_x, datos_y, nroGausianas = 10, funcion = "lineal", pnu = 0.2, 
                    pepoca = 200, pcritFinalizacion = 0.9)
```


